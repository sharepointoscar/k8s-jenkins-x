(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{210:function(e,s,n){e.exports=n.p+"assets/img/jenkins-x-github.a0500d82.png"},220:function(e,s,n){"use strict";n.r(s);var t=n(0),a=Object(t.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"jenkins-x-installation-to-aws"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins-x-installation-to-aws","aria-hidden":"true"}},[e._v("#")]),e._v(" Jenkins X installation to AWS")]),e._v(" "),t("h2",{attrs:{id:"prepare-the-local-working-environment"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prepare-the-local-working-environment","aria-hidden":"true"}},[e._v("#")]),e._v(" Prepare the local working environment")]),e._v(" "),t("div",{staticClass:"tip custom-block"},[t("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),t("p",[e._v("You can skip these steps if you have all the required software already\ninstalled.")])]),e._v(" "),t("p",[e._v("Install necessary software:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("if")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v(" -x /usr/bin/apt "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("then")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt")]),e._v(" update -qq\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("DEBIAN_FRONTEND")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("noninteractive "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt-get")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -y -qq awscli "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" gettext-base "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" jq openssh-client "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("wget")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" /dev/null\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("fi")]),e._v("\n")])])]),t("p",[e._v("Install "),t("a",{attrs:{href:"https://github.com/kubernetes/kubectl",target:"_blank",rel:"noopener noreferrer"}},[e._v("kubectl"),t("OutboundLink")],1),e._v(" binary:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("if")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),e._v(" -x /usr/local/bin/kubectl "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("then")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -s -Lo /usr/local/bin/kubectl https://storage.googleapis.com/kubernetes-release/release/"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -s https://storage.googleapis.com/kubernetes-release/release/stable.txt"),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v("/bin/linux/amd64/kubectl\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("chmod")]),e._v(" a+x /usr/local/bin/kubectl\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("fi")]),e._v("\n")])])]),t("p",[e._v("Install "),t("a",{attrs:{href:"https://github.com/kubernetes/kops",target:"_blank",rel:"noopener noreferrer"}},[e._v("kops"),t("OutboundLink")],1),e._v(":")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("if")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),e._v(" -x /usr/local/bin/kops "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("then")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -s -L "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://github.com/kubernetes/kops/releases/download/1.14.0-alpha.3/kops-linux-amd64"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" /usr/local/bin/kops\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("chmod")]),e._v(" a+x /usr/local/bin/kops\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("fi")]),e._v("\n")])])]),t("p",[e._v("Install "),t("a",{attrs:{href:"https://hub.github.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("hub"),t("OutboundLink")],1),e._v(":")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("if")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),e._v(" -x /usr/local/bin/hub "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("then")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -s -L https://github.com/github/hub/releases/download/v2.12.3/hub-linux-amd64-2.12.3.tgz "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("tar")]),e._v(" xzf - -C /tmp/\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" /tmp/hub-linux-amd64-2.12.3/bin/hub /usr/local/bin/\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("fi")]),e._v("\n")])])]),t("p",[e._v("Install "),t("a",{attrs:{href:"https://github.com/jenkins-x/jx",target:"_blank",rel:"noopener noreferrer"}},[e._v("jx"),t("OutboundLink")],1),e._v(":")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("if")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),e._v(" -x /usr/local/bin/jx "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("then")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -s -L "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://github.com/jenkins-x/jx/releases/download/'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" --silent https://api.github.com/repos/jenkins-x/jx/releases/latest "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" jq -r "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'.tag_name'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v('/jx-linux-amd64.tar.gz"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("tar")]),e._v(" xz "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"jx"')]),e._v(" -C /tmp/\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" jx /usr/local/bin/\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("fi")]),e._v("\n")])])]),t("h2",{attrs:{id:"configure-aws"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#configure-aws","aria-hidden":"true"}},[e._v("#")]),e._v(" Configure AWS")]),e._v(" "),t("div",{staticClass:"warning custom-block"},[t("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),t("p",[e._v("These steps should be done only once")])]),e._v(" "),t("p",[e._v("Authorize to AWS using AWS CLI: "),t("a",{attrs:{href:"https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html"),t("OutboundLink")],1)]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("aws configure\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n")])])]),t("p",[e._v("Create DNS zone:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("aws route53 create-hosted-zone --name "),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${MY_DOMAIN}")]),e._v(" --caller-reference "),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${MY_DOMAIN}")]),e._v("\n")])])]),t("p",[e._v("Use your domain registrar to change the nameservers for your zone (for example\n"),t("code",[e._v("mylabs.dev")]),e._v(") to use the Amazon Route 53 nameservers. Here is the way how you\ncan find out the the Route 53 nameservers:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("aws route53 get-hosted-zone --id "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),e._v("aws route53 list-hosted-zones --query "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"HostedZones[?Name==\\'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")]),e._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("MY_DOMAIN"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")])]),e._v('].Id"')]),e._v(" --output text"),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v(" --query "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"DelegationSet.NameServers"')]),e._v("\n")])])]),t("h2",{attrs:{id:"install-jenkins-x"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-jenkins-x","aria-hidden":"true"}},[e._v("#")]),e._v(" Install Jenkins X")]),e._v(" "),t("p",[e._v("Generate SSH keys if not exists:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("test")]),e._v(" -f "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("$HOME")]),e._v("/.ssh/id_rsa "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("||")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -m 0700 -d "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("$HOME")]),e._v("/.ssh "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" ssh-keygen -b "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("2048")]),e._v(" -t rsa -f "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("$HOME")]),e._v("/.ssh/id_rsa -q -N "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('""')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),t("p",[e._v("Create S3 bucket:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("aws s3api create-bucket --bucket "),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("USER")]),e._v("}")]),e._v("-kops-state-jenkinsx --region eu-central-1 --create-bucket-configuration "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("LocationConstraint")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("eu-central-1\n")])])]),t("p",[e._v("Output:")]),e._v(" "),t("div",{staticClass:"language-text extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('{\n    "Location": "http://pruzicka-kops-state-jenkinsx.s3.amazonaws.com/"\n}\n')])])]),t("p",[e._v("Create Kubernetes cluster in Amazon and install Jenkins X there:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("jx create cluster aws "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --cluster-name"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("USER")]),e._v("}")]),e._v("-jx-k8s.mylabs.dev "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --default-admin-password"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"admin123"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --default-environment-prefix"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"mylabs"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --domain"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"mylabs.dev"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --environment-git-owner"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"ruzickap"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --git-api-token"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$GITHUB_TOKEN")]),e._v('"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --git-provider-url"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://github.com"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --git-username"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"ruzickap"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --kaniko"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("true "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --lts-bucket"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("USER")]),e._v("}")]),e._v("-jx-k8s.mylabs.dev "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --master-size"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("t3.small "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --node-size"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("t3.medium "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --nodes"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --prow"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("true "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --region"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("eu-central-1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --state"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("s3://"),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("USER")]),e._v("}")]),e._v("-kops-state-jenkinsx "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --tags"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Owner='),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("USER")]),e._v("}")]),e._v(',Environment=Test,Division=Services"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --tekton"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("true "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --zones"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("eu-central-1a "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --batch-mode"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("true\n")])])]),t("p",[e._v("Output:")]),e._v(" "),t("div",{staticClass:"language-text extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('Creating cluster...\nrunning command: kops create cluster --name pruzicka-jx-k8s.mylabs.dev --node-count 3 --node-size t3.medium --master-size t3.small --cloud-labels Owner=pruzicka,Environment=Test,Division=Services --authorization RBAC --zones eu-central-1a --yes --state s3://pruzicka-kops-state-jenkinsx\nI1017 17:21:28.448971   16551 create_cluster.go:519] Inferred --cloud=aws from zone "eu-central-1a"\nI1017 17:21:28.547392   16551 subnets.go:184] Assigned CIDR 172.20.32.0/19 to subnet eu-central-1a\nI1017 17:21:29.372569   16551 create_cluster.go:1486] Using SSH public key: /home/pruzicka/.ssh/id_rsa.pub\nI1017 17:21:31.321476   16551 executor.go:103] Tasks: 0 done / 85 total; 43 can run\nI1017 17:21:31.891533   16551 vfs_castore.go:729] Issuing new certificate: "etcd-manager-ca-main"\nI1017 17:21:31.984557   16551 vfs_castore.go:729] Issuing new certificate: "apiserver-aggregator-ca"\nI1017 17:21:31.997063   16551 vfs_castore.go:729] Issuing new certificate: "etcd-clients-ca"\nI1017 17:21:32.055963   16551 vfs_castore.go:729] Issuing new certificate: "ca"\nI1017 17:21:32.247736   16551 vfs_castore.go:729] Issuing new certificate: "etcd-peers-ca-main"\nI1017 17:21:32.250741   16551 vfs_castore.go:729] Issuing new certificate: "etcd-manager-ca-events"\nI1017 17:21:32.288763   16551 vfs_castore.go:729] Issuing new certificate: "etcd-peers-ca-events"\nI1017 17:21:33.010316   16551 executor.go:103] Tasks: 43 done / 85 total; 24 can run\nI1017 17:21:33.612811   16551 vfs_castore.go:729] Issuing new certificate: "kubelet-api"\nI1017 17:21:33.716839   16551 vfs_castore.go:729] Issuing new certificate: "apiserver-proxy-client"\nI1017 17:21:33.769650   16551 vfs_castore.go:729] Issuing new certificate: "kube-scheduler"\nI1017 17:21:33.785984   16551 vfs_castore.go:729] Issuing new certificate: "kube-proxy"\nI1017 17:21:33.882883   16551 vfs_castore.go:729] Issuing new certificate: "kube-controller-manager"\nI1017 17:21:34.021580   16551 vfs_castore.go:729] Issuing new certificate: "apiserver-aggregator"\nI1017 17:21:34.021657   16551 vfs_castore.go:729] Issuing new certificate: "kubelet"\nI1017 17:21:34.042589   16551 vfs_castore.go:729] Issuing new certificate: "kubecfg"\nI1017 17:21:34.081027   16551 vfs_castore.go:729] Issuing new certificate: "kops"\nI1017 17:21:34.123360   16551 vfs_castore.go:729] Issuing new certificate: "master"\nI1017 17:21:34.334705   16551 executor.go:103] Tasks: 67 done / 85 total; 16 can run\nI1017 17:21:34.559352   16551 launchconfiguration.go:364] waiting for IAM instance profile "nodes.pruzicka-jx-k8s.mylabs.dev" to be ready\nI1017 17:21:34.586373   16551 launchconfiguration.go:364] waiting for IAM instance profile "masters.pruzicka-jx-k8s.mylabs.dev" to be ready\nI1017 17:21:44.941708   16551 executor.go:103] Tasks: 83 done / 85 total; 2 can run\nI1017 17:21:45.453092   16551 executor.go:103] Tasks: 85 done / 85 total; 0 can run\nI1017 17:21:45.453203   16551 dns.go:155] Pre-creating DNS records\nI1017 17:21:46.329503   16551 update_cluster.go:294] Exporting kubecfg for cluster\nkops has set your kubectl context to pruzicka-jx-k8s.mylabs.dev\n\nCluster is starting.  It should be ready in a few minutes.\n\nSuggestions:\n * validate cluster: kops validate cluster\n * list nodes: kubectl get nodes --show-labels\n * ssh to the master: ssh -i ~/.ssh/id_rsa admin@api.pruzicka-jx-k8s.mylabs.dev\n * the admin user is specific to Debian. If not using Debian please use the appropriate user based on your OS.\n * read about installing addons at: https://github.com/kubernetes/kops/blob/master/docs/addons.md.\n\n\nkops has created cluster pruzicka-jx-k8s.mylabs.dev it will take a minute or so to startup\nYou can check on the status in another terminal via the command: kops validate cluster\nWARNING: Waiting for the Cluster configuration...\nLoaded Cluster JSON: {"kind":"Cluster","apiVersion":"kops/v1alpha2","metadata":{"name":"pruzicka-jx-k8s.mylabs.dev","creationTimestamp":"2019-10-17T15:21:29Z"},"spec":{"channel":"stable","configBase":"s3://pruzicka-kops-state-jenkinsx/pruzicka-jx-k8s.mylabs.dev","cloudProvider":"aws","kubernetesVersion":"1.14.6","subnets":[{"name":"eu-central-1a","zone":"eu-central-1a","cidr":"172.20.32.0/19","type":"Public"}],"masterPublicName":"api.pruzicka-jx-k8s.mylabs.dev","networkCIDR":"172.20.0.0/16","topology":{"masters":"public","nodes":"public","dns":{"type":"Public"}},"nonMasqueradeCIDR":"100.64.0.0/10","sshAccess":["0.0.0.0/0"],"kubernetesApiAccess":["0.0.0.0/0"],"etcdClusters":[{"name":"main","etcdMembers":[{"name":"a","instanceGroup":"master-eu-central-1a"}],"memoryRequest":"100Mi","cpuRequest":"200m"},{"name":"events","etcdMembers":[{"name":"a","instanceGroup":"master-eu-central-1a"}],"memoryRequest":"100Mi","cpuRequest":"100m"}],"kubelet":{"anonymousAuth":false},"networking":{"kubenet":{}},"api":{"dns":{}},"authorization":{"rbac":{}},"cloudLabels":{"Division":"Services","Environment":"Test","Owner":"pruzicka"},"iam":{"legacy":false,"allowContainerRegistry":true}}}\nnew json: {"apiVersion":"kops/v1alpha2","kind":"Cluster","metadata":{"creationTimestamp":"2019-10-17T15:21:29Z","name":"pruzicka-jx-k8s.mylabs.dev"},"spec":{"additionalPolicies":{"node":"[\\n      {\\n        \\"Effect\\": \\"Allow\\",\\n        \\"Action\\": [\\"ecr:InitiateLayerUpload\\", \\"ecr:UploadLayerPart\\",\\"ecr:CompleteLayerUpload\\",\\"ecr:PutImage\\"],\\n        \\"Resource\\": [\\"*\\"]\\n      }\\n    ]"},"api":{"dns":{}},"authorization":{"rbac":{}},"channel":"stable","cloudLabels":{"Division":"Services","Environment":"Test","Owner":"pruzicka"},"cloudProvider":"aws","configBase":"s3://pruzicka-kops-state-jenkinsx/pruzicka-jx-k8s.mylabs.dev","docker":{"insecureRegistry":"100.64.0.0/10"},"etcdClusters":[{"cpuRequest":"200m","etcdMembers":[{"instanceGroup":"master-eu-central-1a","name":"a"}],"memoryRequest":"100Mi","name":"main"},{"cpuRequest":"100m","etcdMembers":[{"instanceGroup":"master-eu-central-1a","name":"a"}],"memoryRequest":"100Mi","name":"events"}],"iam":{"allowContainerRegistry":true,"legacy":false},"kubelet":{"anonymousAuth":false},"kubernetesApiAccess":["0.0.0.0/0"],"kubernetesVersion":"1.14.6","masterPublicName":"api.pruzicka-jx-k8s.mylabs.dev","networkCIDR":"172.20.0.0/16","networking":{"kubenet":{}},"nonMasqueradeCIDR":"100.64.0.0/10","sshAccess":["0.0.0.0/0"],"subnets":[{"cidr":"172.20.32.0/19","name":"eu-central-1a","type":"Public","zone":"eu-central-1a"}],"topology":{"dns":{"type":"Public"},"masters":"public","nodes":"public"}}}\nUpdating Cluster configuration to enable insecure Docker registries 100.64.0.0/10\nrunning command: kops replace -f /tmp/kops-ig-json-177327770 --state s3://pruzicka-kops-state-jenkinsx\nUpdating the cluster\nrunning command: kops update cluster --yes --state s3://pruzicka-kops-state-jenkinsx\nUsing cluster from kubectl context: pruzicka-jx-k8s.mylabs.dev\n\nI1017 17:21:55.983274   16600 executor.go:103] Tasks: 0 done / 85 total; 43 can run\nI1017 17:21:56.505035   16600 executor.go:103] Tasks: 43 done / 85 total; 24 can run\nI1017 17:21:56.980158   16600 executor.go:103] Tasks: 67 done / 85 total; 16 can run\nI1017 17:21:57.701292   16600 executor.go:103] Tasks: 83 done / 85 total; 2 can run\nI1017 17:21:57.947370   16600 executor.go:103] Tasks: 85 done / 85 total; 0 can run\nI1017 17:21:57.947448   16600 dns.go:155] Pre-creating DNS records\nI1017 17:21:58.332514   16600 update_cluster.go:294] Exporting kubecfg for cluster\nkops has set your kubectl context to pruzicka-jx-k8s.mylabs.dev\n\nCluster changes have been applied to the cloud.\n\n\nChanges may require instances to restart: kops rolling-update cluster\n\nRolling update the cluster\nrunning command: kops rolling-update cluster --cloudonly --yes --state s3://pruzicka-kops-state-jenkinsx\nUsing cluster from kubectl context: pruzicka-jx-k8s.mylabs.dev\n\nNAME                    STATUS          NEEDUPDATE      READY   MIN     MAX\nmaster-eu-central-1a    NeedsUpdate     1               0       1       1\nnodes                   NeedsUpdate     3               0       3       3\nW1017 17:21:59.568219   16640 instancegroups.go:160] Not draining cluster nodes as \'cloudonly\' flag is set.\nI1017 17:21:59.568277   16640 instancegroups.go:305] Stopping instance "i-09aeae26e862ccecf", in group "master-eu-central-1a.masters.pruzicka-jx-k8s.mylabs.dev" (this may take a while).\nE1017 17:21:59.724738   16640 instancegroups.go:193] error deleting instance "i-09aeae26e862ccecf", node "": error deleting instance "i-09aeae26e862ccecf": error deleting instance "i-09aeae26e862ccecf": ScalingActivityInProgress: Activity 91c5b769-3e22-2c98-fdfd-8386a761f7c4 is in progress.\n        status code: 400, request id: dcebdb93-f0f1-11e9-bc6b-b5635534ce36\n\nmaster not healthy after update, stopping rolling-update: "error deleting instance \\"i-09aeae26e862ccecf\\": error deleting instance \\"i-09aeae26e862ccecf\\": ScalingActivityInProgress: Activity 91c5b769-3e22-2c98-fdfd-8386a761f7c4 is in progress.\\n\\tstatus code: 400, request id: dcebdb93-f0f1-11e9-bc6b-b5635534ce36"\nERROR: Error: Command failed  kops rolling-update cluster --cloudonly --yes --state s3://pruzicka-kops-state-jenkinsx\nWARNING: Failed to perform rolling upgrade: exit status 1\nCluster configuration updated\nWaiting for the Kubernetes cluster to be ready so we can continue...\nWARNING: retrying after error: exit status 1\n.\n\n\nWaiting to for a valid kops cluster state...\nWARNING: retrying after error: exit status 2\n.\n\nState of kops cluster: OK\n\nInitialising cluster ...\nNamespace jx created\nContext "pruzicka-jx-k8s.mylabs.dev" modified.\nUpdating storageclass gp2 to be the default\nGit configured for user: Petr Ruzicka and email petr.ruzicka@gmail.com\nhelm installed and configured\nUsing helm values file: /tmp/ing-values-187813169\nDeleting and cloning the Jenkins X versions repo\nCloning the Jenkins X versions repo https://github.com/jenkins-x/jenkins-x-versions.git with ref refs/heads/master to /home/pruzicka/.jx/jenkins-x-versions\n\nWaiting for external loadbalancer to be created and update the nginx-ingress-controller service in kube-system namespace\nExternal loadbalancer created\n\nWaiting to find the external host name of the ingress controller Service in namespace kube-system with name jxing-nginx-ingress-controller\nAbout to insert/update DNS CNAME record into HostedZone /hostedzone/ZY5AEYFXDBT4P with wildcard *.mylabs.dev pointing to abb6dc8b3f0f211e9b6c6029d77b9317-f6354a2b37f1f6d2.elb.eu-central-1.amazonaws.com\nUpdated HostZone ID /hostedzone/ZY5AEYFXDBT4P successfully\nnginx ingress controller installed and configured\n? Configured to use long term logs storage: No\nSet up a Git username and API token to be able to perform CI/CD\nSelect the CI/CD pipelines Git server and user\nSetting the pipelines Git server https://github.com and user name ruzickap.\nCloning the Jenkins X cloud environments repo to /home/pruzicka/.jx/cloud-environments\nEnumerating objects: 1440, done.\nTotal 1440 (delta 0), reused 0 (delta 0), pack-reused 1440\nwe are assuming your IAM roles are setup so that Kaniko can push images to your docker registry\nSetting up prow config into namespace jx\nInstalling tekton into namespace jx\n\nInstalling Prow into namespace jx\nwith values file /home/pruzicka/.jx/cloud-environments/env-aws/myvalues.yaml\n\nInstalling jx into namespace jx\nInstalling jenkins-x-platform version: 2.0.1476\n\n\nWARNING: waiting for install to be ready, if this is the first time then it will take a while to download images\nJenkins X deployments ready in namespace jx\nConfiguring the TeamSettings for ImportMode YAML\nCreating default staging and production environments\nUsing Git provider GitHub at https://github.com\n? Using Git user name: ruzickap\n? Using organisation: ruzickap\nCreating repository ruzickap/environment-mylabs-staging\nCreating Git repository ruzickap/environment-mylabs-staging\nPushed Git repository to https://github.com/ruzickap/environment-mylabs-staging\n\nCreating staging Environment in namespace jx\nCreated environment staging\nNamespace jx-staging created\nCreating GitHub webhook for ruzickap/environment-mylabs-staging for url http://hook.jx.mylabs.dev/hook\nUsing Git provider GitHub at https://github.com\n? Using Git user name: ruzickap\n? Using organisation: ruzickap\nCreating repository ruzickap/environment-mylabs-production\nCreating Git repository ruzickap/environment-mylabs-production\nPushed Git repository to https://github.com/ruzickap/environment-mylabs-production\n\nCreating production Environment in namespace jx\nCreated environment production\nNamespace jx-production created\nCreating GitHub webhook for ruzickap/environment-mylabs-production for url http://hook.jx.mylabs.dev/hook\n\nJenkins X installation completed successfully\n\n\n        ********************************************************\n\n             NOTE: Your admin password is: admin123\n\n        ********************************************************\n\n\nYour Kubernetes context is now set to the namespace: jx\nTo switch back to your original namespace use: jx namespace default\nOr to use this context/namespace in just one terminal use: jx shell\nFor help on switching contexts see: https://jenkins-x.io/developing/kube-context/\nTo import existing projects into Jenkins:       jx import\nTo create a new Spring Boot microservice:       jx create spring -d web -d actuator\nTo create a new microservice from a quickstart: jx create quickstart\n')])])]),t("p",[e._v("You can see the production and staging repository created by Jenkins X\nin GitHub:")]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://github.com/ruzickap/environment-mylabs-production",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/ruzickap/environment-mylabs-production"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://github.com/ruzickap/environment-mylabs-staging",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/ruzickap/environment-mylabs-staging"),t("OutboundLink")],1)])])]),e._v(" "),t("p",[t("img",{attrs:{src:n(210),alt:"GitHub https://github.com/ruzickap/environment-mylabs-production repository",title:"GitHub https://github.com/ruzickap/environment-mylabs-production repository"}})]),e._v(" "),t("p",[e._v("Few commands showing the Jenkins X installation inside Kubernetes:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("kubectl get all -n jx\n")])])]),t("p",[e._v("Output:")]),e._v(" "),t("div",{staticClass:"language-text extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("NAME                                               READY   STATUS      RESTARTS   AGE\npod/crier-7c58ff4897-zm8xb                         1/1     Running     0          3m11s\npod/deck-b5b568797-4mnk4                           1/1     Running     0          3m11s\npod/deck-b5b568797-cn6kp                           1/1     Running     0          3m11s\npod/hook-6596bbffb9-csps9                          1/1     Running     0          3m10s\npod/hook-6596bbffb9-dhp97                          1/1     Running     0          3m10s\npod/horologium-749f6fb97b-h7lnx                    1/1     Running     0          3m10s\npod/jenkins-x-chartmuseum-d87cbb789-chbmw          1/1     Running     0          3m6s\npod/jenkins-x-controllerbuild-79bfc84b6c-gtd82     1/1     Running     0          3m4s\npod/jenkins-x-controllerrole-5ddcc565bc-6c8s7      1/1     Running     0          3m3s\npod/jenkins-x-docker-registry-69d666d455-sjq29     1/1     Running     0          3m4s\npod/jenkins-x-gcactivities-1571326200-kcbvq        0/1     Completed   0          108s\npod/jenkins-x-gcpods-1571326200-b8gsz              0/1     Completed   0          108s\npod/jenkins-x-heapster-5b7df679f6-rlnwk            2/2     Running     0          78s\npod/jenkins-x-nexus-6bc788447f-lgl78               1/1     Running     0          3m3s\npod/pipeline-67d685f957-s6qtq                      1/1     Running     0          3m11s\npod/pipelinerunner-64c59f6955-bvndw                1/1     Running     0          3m10s\npod/plank-9857d5b64-9q772                          1/1     Running     0          3m10s\npod/sinker-54bdd4fd45-hn6sq                        1/1     Running     0          3m10s\npod/tekton-pipelines-controller-786b485fc5-22crp   1/1     Running     0          3m18s\npod/tekton-pipelines-webhook-56cd88ddb5-4qszx      1/1     Running     0          3m18s\npod/tide-7ccc78d964-9sz58                          1/1     Running     0          3m10s\n\nNAME                                  TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)    AGE\nservice/deck                          ClusterIP   100.71.61.115    <none>        80/TCP     3m11s\nservice/heapster                      ClusterIP   100.69.151.211   <none>        8082/TCP   3m3s\nservice/hook                          ClusterIP   100.67.39.57     <none>        80/TCP     3m11s\nservice/jenkins-x-chartmuseum         ClusterIP   100.71.138.207   <none>        8080/TCP   3m5s\nservice/jenkins-x-docker-registry     ClusterIP   100.70.162.95    <none>        5000/TCP   3m4s\nservice/nexus                         ClusterIP   100.67.123.35    <none>        80/TCP     3m3s\nservice/pipelinerunner                ClusterIP   100.69.141.214   <none>        80/TCP     3m10s\nservice/tekton-pipelines-controller   ClusterIP   100.68.10.229    <none>        9090/TCP   3m19s\nservice/tekton-pipelines-webhook      ClusterIP   100.69.85.27     <none>        443/TCP    3m19s\nservice/tide                          ClusterIP   100.68.57.205    <none>        80/TCP     3m10s\n\nNAME                                          READY   UP-TO-DATE   AVAILABLE   AGE\ndeployment.apps/crier                         1/1     1            1           3m12s\ndeployment.apps/deck                          2/2     2            2           3m11s\ndeployment.apps/hook                          2/2     2            2           3m11s\ndeployment.apps/horologium                    1/1     1            1           3m11s\ndeployment.apps/jenkins-x-chartmuseum         1/1     1            1           3m6s\ndeployment.apps/jenkins-x-controllerbuild     1/1     1            1           3m5s\ndeployment.apps/jenkins-x-controllerrole      1/1     1            1           3m4s\ndeployment.apps/jenkins-x-docker-registry     1/1     1            1           3m4s\ndeployment.apps/jenkins-x-heapster            1/1     1            1           3m3s\ndeployment.apps/jenkins-x-nexus               1/1     1            1           3m3s\ndeployment.apps/pipeline                      1/1     1            1           3m11s\ndeployment.apps/pipelinerunner                1/1     1            1           3m11s\ndeployment.apps/plank                         1/1     1            1           3m10s\ndeployment.apps/sinker                        1/1     1            1           3m10s\ndeployment.apps/tekton-pipelines-controller   1/1     1            1           3m18s\ndeployment.apps/tekton-pipelines-webhook      1/1     1            1           3m18s\ndeployment.apps/tide                          1/1     1            1           3m10s\n\nNAME                                                     DESIRED   CURRENT   READY   AGE\nreplicaset.apps/crier-7c58ff4897                         1         1         1       3m12s\nreplicaset.apps/deck-b5b568797                           2         2         2       3m11s\nreplicaset.apps/hook-6596bbffb9                          2         2         2       3m11s\nreplicaset.apps/horologium-749f6fb97b                    1         1         1       3m11s\nreplicaset.apps/jenkins-x-chartmuseum-d87cbb789          1         1         1       3m6s\nreplicaset.apps/jenkins-x-controllerbuild-79bfc84b6c     1         1         1       3m5s\nreplicaset.apps/jenkins-x-controllerrole-5ddcc565bc      1         1         1       3m4s\nreplicaset.apps/jenkins-x-docker-registry-69d666d455     1         1         1       3m4s\nreplicaset.apps/jenkins-x-heapster-5b7df679f6            1         1         1       78s\nreplicaset.apps/jenkins-x-heapster-6457df4bd8            0         0         0       3m3s\nreplicaset.apps/jenkins-x-nexus-6bc788447f               1         1         1       3m3s\nreplicaset.apps/pipeline-67d685f957                      1         1         1       3m11s\nreplicaset.apps/pipelinerunner-64c59f6955                1         1         1       3m11s\nreplicaset.apps/plank-9857d5b64                          1         1         1       3m10s\nreplicaset.apps/sinker-54bdd4fd45                        1         1         1       3m10s\nreplicaset.apps/tekton-pipelines-controller-786b485fc5   1         1         1       3m18s\nreplicaset.apps/tekton-pipelines-webhook-56cd88ddb5      1         1         1       3m18s\nreplicaset.apps/tide-7ccc78d964                          1         1         1       3m10s\n\nNAME                                          COMPLETIONS   DURATION   AGE\njob.batch/jenkins-x-gcactivities-1571326200   1/1           58s        108s\njob.batch/jenkins-x-gcpods-1571326200         1/1           59s        108s\n\nNAME                                   SCHEDULE         SUSPEND   ACTIVE   LAST SCHEDULE   AGE\ncronjob.batch/jenkins-x-gcactivities   0/30 */3 * * *   False     0        108s            3m4s\ncronjob.batch/jenkins-x-gcpods         0/30 */3 * * *   False     0        108s            3m4s\ncronjob.batch/jenkins-x-gcpreviews     0 */3 * * *      False     0        <none>          3m3s\n")])])]),t("p",[e._v("Look at the "),t("code",[e._v("ingress")]),e._v(" and "),t("code",[e._v("endpoints")]),e._v(":")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("kubectl get ingress,endpoints\n")])])]),t("p",[e._v("Output:")]),e._v(" "),t("div",{staticClass:"language-text extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("NAME                                 HOSTS                           ADDRESS                                                                            PORTS   AGE\ningress.extensions/chartmuseum       chartmuseum.jx.mylabs.dev       abb6dc8b3f0f211e9b6c6029d77b9317-f6354a2b37f1f6d2.elb.eu-central-1.amazonaws.com   80      2m57s\ningress.extensions/deck              deck.jx.mylabs.dev              abb6dc8b3f0f211e9b6c6029d77b9317-f6354a2b37f1f6d2.elb.eu-central-1.amazonaws.com   80      2m57s\ningress.extensions/docker-registry   docker-registry.jx.mylabs.dev   abb6dc8b3f0f211e9b6c6029d77b9317-f6354a2b37f1f6d2.elb.eu-central-1.amazonaws.com   80      2m56s\ningress.extensions/hook              hook.jx.mylabs.dev              abb6dc8b3f0f211e9b6c6029d77b9317-f6354a2b37f1f6d2.elb.eu-central-1.amazonaws.com   80      2m56s\ningress.extensions/nexus             nexus.jx.mylabs.dev             abb6dc8b3f0f211e9b6c6029d77b9317-f6354a2b37f1f6d2.elb.eu-central-1.amazonaws.com   80      2m56s\ningress.extensions/tide              tide.jx.mylabs.dev              abb6dc8b3f0f211e9b6c6029d77b9317-f6354a2b37f1f6d2.elb.eu-central-1.amazonaws.com   80      2m57s\n\nNAME                                    ENDPOINTS                         AGE\nendpoints/deck                          100.96.1.4:8080,100.96.3.4:8080   3m11s\nendpoints/heapster                      100.96.3.10:8082                  3m3s\nendpoints/hook                          100.96.1.8:8888,100.96.3.7:8888   3m11s\nendpoints/jenkins-x-chartmuseum         100.96.3.8:8080                   3m5s\nendpoints/jenkins-x-docker-registry     100.96.1.10:5000                  3m4s\nendpoints/nexus                         100.96.2.10:8081                  3m3s\nendpoints/pipelinerunner                100.96.2.5:8080                   3m10s\nendpoints/tekton-pipelines-controller   100.96.3.3:9090                   3m19s\nendpoints/tekton-pipelines-webhook      100.96.2.4:8443                   3m19s\nendpoints/tide                          100.96.2.6:8888                   3m10s\n")])])]),t("p",[e._v("You can also use "),t("code",[e._v("jx get environments")]),e._v(" to get the environments:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("kubectl get environments -n jx\n")])])]),t("p",[e._v("Output:")]),e._v(" "),t("div",{staticClass:"language-text extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("NAME         NAMESPACE       KIND          PROMOTION   ORDER   GIT URL                                                         GIT BRANCH\ndev          jx              Development   Never\nproduction   jx-production   Permanent     Manual      200     https://github.com/ruzickap/environment-mylabs-production.git\nstaging      jx-staging      Permanent     Auto        100     https://github.com/ruzickap/environment-mylabs-staging.git\n")])])]),t("p",[e._v("Or you can use the "),t("code",[e._v("jx")]),e._v(" command to see the environments:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("jx get "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("env")]),e._v("\n")])])]),t("p",[e._v("Output:")]),e._v(" "),t("div",{staticClass:"language-text extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("NAME       LABEL       KIND        PROMOTE NAMESPACE     ORDER CLUSTER SOURCE                                                        REF PR\ndev        Development Development Never   jx            0\nstaging    Staging     Permanent   Auto    jx-staging    100           https://github.com/ruzickap/environment-mylabs-staging.git\nproduction Production  Permanent   Manual  jx-production 200           https://github.com/ruzickap/environment-mylabs-production.git\n")])])]),t("p",[e._v("Install Tekton Dashboard to see the details of the builds:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -sL https://github.com/tektoncd/dashboard/releases/download/v0.2.0/release.yaml "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"s/namespace: tekton-pipelines/namespace: jx/"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" kubectl apply -f -\n")])])]),t("p",[e._v("Output:")]),e._v(" "),t("div",{staticClass:"language-text extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("serviceaccount/tekton-dashboard created\ncustomresourcedefinition.apiextensions.k8s.io/extensions.dashboard.tekton.dev created\nclusterrole.rbac.authorization.k8s.io/tekton-dashboard-minimal created\nclusterrolebinding.rbac.authorization.k8s.io/tekton-dashboard-minimal created\ndeployment.apps/tekton-dashboard created\nservice/tekton-dashboard created\ntask.tekton.dev/pipeline0-task created\npipeline.tekton.dev/pipeline0 created\n")])])]),t("p",[e._v("Create Ingress for Tekton Dashboard:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" EOF "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" kubectl apply -f -\napiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n  name: tekton-dashboard\n  namespace: jx\n  annotations:\n    kubernetes.io/ingress.class: nginx\n    nginx.ingress.kubernetes.io/auth-secret: jx-basic-auth\n    nginx.ingress.kubernetes.io/auth-type: basic\nspec:\n  rules:\n    - host: tekton-dashboard.jx.mylabs.dev\n      http:\n        paths:\n          - backend:\n              serviceName: tekton-dashboard\n              servicePort: "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("9097")]),e._v("\n            path: /\nEOF\n")])])]),t("p",[e._v("Output:")]),e._v(" "),t("div",{staticClass:"language-text extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("ingress.extensions/tekton-dashboard created\n")])])])])}),[],!1,null,null,null);s.default=a.exports}}]);